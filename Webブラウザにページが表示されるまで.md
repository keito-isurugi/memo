# Webページがブラウザに表示されるまでに何が起こるのか？

## URL解析
- プロトコル、ドメイン名、パス名
- 有効なURLではない場合、ブラウザデフォルトの検索エンジン

## HSTS ( HTTP Strict Transport Security ) を調べる
- ブラウザが自動で https に置き換えてアクセスしてくれる機能

## DNSでIPアドレスを取得
- DNS ( Domain Name System ) は、IPアドレスとドメイン名の対応づけを行うシステム

### ブラウザのキャッシュを調べる
- キャッシュに残っていれば名前解決完了。ない場合は次のステップへ。
- chrome://net-internals/#dns

### hostsファイルを調べる
- hostsファイルはOSの設定ファイル。TCP/IPネットワーク上のIPアドレスとホスト名の対応を記述するテキストファイル。
	- 自分のPCで確認
		- sudo vi /private/etc/hosts
			- 127.0.0.1 localhost 
- ファイル内に対象のホスト名があれば完了。なければ次へ。

### スタブリゾルバを呼び出す
- クライアントのPCの中にOSとして備わっている機能
- hostsファイルに対象の ドメイン名 のIPアドレスがなかったら、DNSサーバに問い合わせ。

### キャッシュDNSサーバを見に行く
- 問い合わせのIPアドレスを一定期間保存。
- IPアドレスがあれば完了。なければ次へ。

### キャッシュDNSサーバにキャッシュがない
- 「ルートネームサーバ」 → 「.comのネームサーバ」 → 「〇〇.comのネームサーバ」 へと順に問い合わせ

## ポート番号
- プロトコルに割り当てられた番号
- URLのドメイン名の末尾に：ポート番号と入力
- 「http:」だったら80番、「https」だったら443番
- 普段入力しないのはブラウザが自動で判別してくれるから

## HTTPリクエストの送信
- URL解読後、ブラウザがHTTPリクエスト作成
- 「リクエストライン」と「ヘッダー」と「メッセージボディ」という構成
- リクエストラインで「GET」「POST」など
- ヘッダーで「ユーザーエージェントなど」
- メッセージボディでPOSTの際に値を送信


## ロードバランサー
- 負荷分散装置
- 複数台のWebサーバを束ねて、Webサーバに来たリクエストをバランス良く振り分ける装置
### ヘルスチェック
- 配下にあるWebサーバが正常に稼働しているかどうかを常にチェックする機能
- 以上なら他のサーバーへ
### セッション維持
- 同一ユーザーからのアクセスは同じサーバに振り分ける機能
- ログインなどに必要


## HTTPレスポンスの送信
- 「ステータスライン」、「ヘッダー」、「メッセージボディ」という構成
- ステータスラインはレスポンスの状態。200, 404, 500など
- ヘッダーはコンテンツタイプや文字コードなど
- メッセージボディはHTMLなど

## HTMLのレンダリング
- Loading
	- リソースの読み込み
		- 最初はHTMLファイルから
			- 上から順番に読み込まれる。cssやjs、画像は都度問い合わせ
	- 読み込んだリソースは、レンダリングエンジンの内部リソースに変換
		- HTMLはDOMツリーに、CSSはCSSOMツリーにそれぞれ変換
			- RenderingやPaintingで利用 
- Scripting
	- jsの実行
		- 字句解析 → 構文解析 → コンパイル → 実行
- Reanderign
	- レイアウトツリーの構築
- Painting
	- レンダリング結果の描画


## JSONデータの取得
- 欲しいリソースをメッセージボディに記載
- ヘッダーにはcontent-type:application/jsonと指定
